<div class="row">
    <div class="col-md-10 col-md-offset-1"><h2 class="page-header text-center">Issue Invoice</h2>


        <div>

            <uib-tabset active="active">
                <uib-tab index="0" heading="Company invoice">


                    <div class="col-md-6">
                        <div class="findCompanyInput">
                            <div class="row well">

                                <label class="col-sm-5">Find contractor by NIP:</label>
                                <div class="input-group col-md-6">
                                    <div class="typeahead-demo"><input type="text" ng-model="issueInvoiceCtrl.asyncSelected" placeholder="NIP contractors"
                                                                       uib-typeahead="companies.nip for companies in issueInvoiceCtrl.findCompaniesByNip($viewValue)"
                                                                       typeahead-loading="issueInvoiceCtrl.loadingLocations"
                                                                       typeahead-no-results="issueInvoiceCtrl.noResults" class="form-control"
                                                                       typeahead-on-select="issueInvoiceCtrl.onSelect($item,$model,$label)"
                                                                       typeahead-template-url="modules/invoices/add/getNips.tpl.html">
                                        <i ng-show="issueInvoiceCtrl.loadingLocations" class="glyphicon glyphicon-refresh"></i>
                                        <div ng-show="issueInvoiceCtrl.noResults">
                                            <i class="glyphicon glyphicon-remove"></i>
                                            <p class="text-justify">Company not found,<br>
                                                to add new company click <a href="" ng-click="issueInvoiceCtrl.openAddCompanyModal('lg')">here</a></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 findCompanyInput">
                        <contractor-info ng-show="issueInvoiceCtrl.showBox" company="issueInvoiceCtrl.companyDetails"></contractor-info>
                        <div class="well" ng-show="!issueInvoiceCtrl.showBox"><strong>Enter NIP to find company</strong></div>
                    </div>

                    <div class="col-md-12 tabs-top-marg">
                        <form class="form-horizontal" name="issueCompany" ng-submit="issueInvoiceCtrl.addInvoiceCompany(issueCompany)" novalidate>
                            <div class="form-group">
                                <label for="invoice_nr" class="col-lg-2 col-lg-2 col-sm-3 control-label">Invoice number</label>
                                <div class="col-lg-9 col-sm-9">
                                    <input type="text" ng-minlength="5" class="form-control" name="invoiceNumber" id="invoice_nr" placeholder="Invoice number"
                                           ng-model="issueInvoiceCtrl.invoiceCompany.invoiceNr" required>
                                    <div ng-messages="issueCompany.invoiceNumber.$error" class="input-error" role="alert">
                                        <div ng-if="issueCompany.$submitted" ng-message="required">Please enter a value for this field.</div>
                                        <div ng-message="minlength">Invoice ID required min. length is 5</div>
                                    </div>
                                </div>

                            </div>
                            <div class="form-group">
                                <label for="invoice_create_date" class="col-lg-2 col-sm-3 control-label">Create date</label>
                                <div class="col-lg-2 col-lg-2 col-sm-3">
                                    <p class="input-group">
                                        <input type="text" class="form-control" uib-datepicker-popup ng-model="issueInvoiceCtrl.createDatePicker.date"
                                               is-open="issueInvoiceCtrl.createDatePicker.opened" datepicker-options="issueInvoiceCtrl.createDatePicker.options"
                                               ng-required="true" close-text="Close" id="invoice_create_date" required ng-change="issueInvoiceCtrl.getInvoiceNumber()"/>
                                        <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="issueInvoiceCtrl.createDatePicker.open()"><i
                                                class="glyphicon glyphicon-calendar"></i></button>
                                        </span>
                                    </p>
                                </div>

                                <label for="invoice_expire_date" class="col-lg-2 col-sm-3 control-label">Expire date</label>
                                <div class="col-lg-2 col-sm-3">
                                    <p class="input-group">
                                        <input type="text" class="form-control" uib-datepicker-popup ng-model="issueInvoiceCtrl.executionDatePicker.date"
                                               is-open="issueInvoiceCtrl.executionDatePicker.opened"
                                               datepicker-options="issueInvoiceCtrl.executionDatePicker.options" ng-required="true" close-text="Close"
                                               id="invoice_expire_date" required/>
                                        <span class="input-group-btn">
                                            <button type="button" class="btn btn-default" ng-click="issueInvoiceCtrl.executionDatePicker.open()"><i
                                                    class="glyphicon glyphicon-calendar"></i></button>
                                        </span>
                                    </p>
                                </div>
                            </div>


                            <div class="form-group">
                                <div class="col-lg-9 col-lg-offset-2 col-sm-offset-3 col-sm-9">
                                    <button type="button" class="btn btn-info" ng-click="issueInvoiceCtrl.openAddEditProductModal()">Add new product/service
                                    </button>
                                </div>
                            </div>

                            <div class="col-lg-9 col-lg-offset-2 col-sm-9 col-sm-offset-3" ng-if="issueInvoiceCtrl.showNewProduct()">
                                <table class="table table-responsive">
                                    <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Amount</th>
                                        <th>Netto</th>
                                        <th>Vat</th>
                                        <th>Brutto</th>
                                        <th></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr ng-repeat="(key,value) in issueInvoiceCtrl.invoiceCompany.products">
                                        <td>{{value.name}}</td>
                                        <td>{{value.amount}}</td>
                                        <td>{{value.netto}}</td>
                                        <td>{{value.vat}}</td>
                                        <td>{{value.brutto}}</td>
                                        <td>
                                            <button class="btn btn-danger btn-sm" type="button" ng-click="issueInvoiceCtrl.deleteProduct(key)">
                                                <i class="glyphicon glyphicon-remove-circle"></i> Delete
                                            </button>
                                            <button class="btn btn-primary btn-sm" type="button" ng-click="issueInvoiceCtrl.openAddEditProductModal(key)">
                                                <i class="glyphicon glyphicon-edit"></i> Edit
                                            </button>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>


                            <div class="form-group">
                                <label for="netto" class="col-lg-2 col-sm-3 control-label">Netto</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="netto" name="netto" placeholder="Netto"
                                           ng-model="issueInvoiceCtrl.invoiceCompany.nettoValue" required>
                                    <div ng-messages="issueCompany.netto.$error" class="input-error" role="alert">
                                        <div ng-if="issueCompany.$submitted" ng-message="required">Please enter a value for this field.</div>
                                    </div>
                                </div>
                            </div>


                            <div class="form-group">
                                <label for="brutto" class="col-lg-2 col-sm-3 control-label">Brutto</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" id="brutto" name="brutto" placeholder="Brutto"
                                           ng-model="issueInvoiceCtrl.invoiceCompany.bruttoValue" required>
                                    <div ng-messages="issueCompany.brutto.$error" class="input-error" role="alert">
                                        <div ng-if="issueCompany.$submitted" ng-message="required">Please enter a value for this field.</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-lg-2 col-sm-3 control-label">Status</label>
                                <div class="col-sm-9">
                                    <label><input type="radio" ng-model="issueInvoiceCtrl.invoiceCompany.status" name="status" value="paid"
                                                  ng-required="!issueInvoiceCtrl.status">Paid</label>
                                    <label><input type="radio" ng-model="issueInvoiceCtrl.invoiceCompany.status" name="status" value="unpaid"
                                                  ng-required="!issueInvoiceCtrl.status">Unpaid</label>
                                    <div ng-messages="issueCompany.status.$error" class="input-error" role="alert">
                                        <div ng-if="issueCompany.$submitted" ng-message="required">
                                            Choose one of the options
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-lg-2 col-sm-3 control-label">Description</label>
                                <div class="col-sm-9">
                                    <textarea class="form-control" ng-model="issueInvoiceCtrl.invoiceCompany.description"></textarea>
                                </div>
                            </div>


                            <div class="col-lg-offset-2 col-lg-9 col-sm-offset-3 col-sm-9"><div ng-show="issueInvoiceCtrl.issueCompanyNotChosen" uib-alert class="alert-danger" close="issueInvoiceCtrl.closeNoCompanyAlert()">
                                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                <span class="sr-only">Error:</span>
                                Company has not been chosen!
                            </div>
                            <div ng-show="issueInvoiceCtrl.issueProductNotAdded" uib-alert class="alert-danger" close="issueInvoiceCtrl.closeProductNotAdded()">
                                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                <span class="sr-only">Error:</span>
                                Not added product/service!
                            </div>

                            <div ng-show="issueInvoiceCtrl.formInvalidAlert" uib-alert class="alert-danger" close="issueInvoiceCtrl.closeFormInvalidAlert()">
                                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                <span class="sr-only">Error:</span>
                                {{issueInvoiceCtrl.errorMessage}}
                            </div>

                            <div ng-show="issueInvoiceCtrl.addInvoice" uib-alert class="alert-success" close="issueInvoiceCtrl.closeAddInvoiceSuccess()">
                                <span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span>
                                <span class="sr-only">Success:</span>
                                Invoice Added
                            </div>
</div>
                            <div class="form-group">
                                <div class="col-lg-offset-2 col-sm-offset-3 col-lg-9 col-sm-9">
                                    <button type="submit" class="btn btn-default">Add</button>
                                </div>
                            </div>
                        </form>

                    </div>
                </uib-tab>

                <!--PERSON FORM-->

                <uib-tab index="1" heading="Person invoice">

                    <div class="col-md-12 tabs-top-marg">
                        <form class="form-horizontal" name="person" ng-submit="issueInvoiceCtrl.addInvoicePerson()" novalidate>

                            <div class="form-group">
                                <label class="col-lg-2 col-sm-3 control-label">Type of transaction</label>
                                <div class="col-sm-9">
                                    <label><input type="radio" ng-model="issueInvoiceCtrl.transationType" name="transitionType" value="sell"
                                                  ng-required="!issueInvoiceCtrl.transitionType">Sell</label>
                                    <label><input type="radio" ng-model="issueInvoiceCtrl.transationType" name="transitionType" value="buy"
                                                  ng-required="!issueInvoiceCtrl.transitionType">Buy</label>
                                    <div ng-messages="person.transitionType.$error" class="input-error" role="alert">
                                        <div ng-if="person.$submitted" ng-message="required">
                                            Choose one of the options
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="url_comp" class="col-lg-2 col-sm-3 control-label">Add file</label>
                                <div class="col-sm-9">
                                    <input type="file" ngf-select ng-model="issueInvoiceCtrl.file" ngf-pattern="'image/*,application/pdf'" name="file"
                                           accept="/*" required>
                                    <div ng-messages="company.file.$error" class="input-error" role="alert">
                                        <div ng-if="person.$submitted" ng-message="required">Please choose a file
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="invoice_nr_person" class="col-lg-2 col-sm-3 control-label">Invoice number</label>
                                <div class="col-sm-9">
                                    <input type="text" ng-minlength="5" class="form-control" name="invoiceNumberPerson" id="invoice_nr_person"
                                           placeholder="Invoice number" ng-model="issueInvoiceCtrl.invoicePerson.invoiceNr" required>
                                    <div ng-messages="person.invoiceNumberPerson.$error" class="input-error" role="alert">
                                        <div ng-if="person.$submitted" ng-message="required">Please enter a value for this field.</div>
                                        <div ng-message="minlength">Invoice ID required min. length is 5</div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="invoice_create_date_per" class="col-lg-2 col-sm-3 control-label">Create date</label>
                                <div class="col-sm-9">
                                    <p class="input-group">
                                        <input type="text" class="form-control" uib-datepicker-popup ng-model="issueInvoiceCtrl.createDatePicker.date"
                                               is-open="issueInvoiceCtrl.createDatePicker.opened" datepicker-options="issueInvoiceCtrl.createDatePicker.options"
                                               ng-required="true" close-text="Close" id="invoice_create_date_per" required/>
                                        <span class="input-group-btn">
            <button type="button" class="btn btn-default" ng-click="issueInvoiceCtrl.createDatePicker.open()"><i
                    class="glyphicon glyphicon-calendar"></i></button>
          </span>
                                    </p>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="invoice_expire_date_per" class="col-lg-2 col-sm-3 control-label">Expire date</label>
                                <div class="col-sm-9">
                                    <p class="input-group">
                                        <input type="text" class="form-control" uib-datepicker-popup ng-model="issueInvoiceCtrl.executionDatePicker.date"
                                               is-open="issueInvoiceCtrl.executionDatePicker.opened"
                                               datepicker-options="issueInvoiceCtrl.executionDatePicker.options" ng-required="true" close-text="Close"
                                               id="invoice_expire_date_per" required/>
                                        <span class="input-group-btn">
            <button type="button" class="btn btn-default" ng-click="issueInvoiceCtrl.executionDatePicker.open()"><i
                    class="glyphicon glyphicon-calendar"></i></button>
          </span>
                                    </p>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="netto_per" class="col-lg-2 col-sm-3 control-label">Netto</label>
                                <div class="col-sm-9">
                                    <input type="text" name="netto" class="form-control" id="netto_per" placeholder="Netto"
                                           ng-model="issueInvoiceCtrl.invoicePerson.nettoValue" required>
                                    <div ng-messages="person.netto.$error" class="input-error" role="alert">
                                        <div ng-if="person.$submitted" ng-message="required">Please enter a value for this field.</div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="brutto_per" class="col-lg-2 col-sm-3 control-label">Brutto</label>
                                <div class="col-sm-9">
                                    <input type="text" name="brutto" class="form-control" id="brutto_per" placeholder="Brutto"
                                           ng-model="issueInvoiceCtrl.invoicePerson.bruttoValue" required>
                                    <div ng-messages="person.brutto.$error" class="input-error" role="alert">
                                        <div ng-if="person.$submitted" ng-message="required">Please enter a value for this field.</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-lg-2 col-sm-3 control-label">Status</label>
                                <div class="col-sm-9">
                                    <label><input type="radio" ng-model="issueInvoiceCtrl.invoicePerson.status" name="status" value="paid"
                                                  ng-required="!issueInvoiceCtrl.status">Paid</label>
                                    <label><input type="radio" ng-model="issueInvoiceCtrl.invoicePerson.status" name="status" value="unpaid"
                                                  ng-required="!issueInvoiceCtrl.status">Unpaid</label>
                                    <div ng-messages="person.status.$error" class="input-error" role="alert">
                                        <div ng-if="person.$submitted" ng-message="required">
                                            Choose one of the options
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <div class="col-sm-offset-3 col-sm-9">
                                    <input type="submit" class="btn btn-default" value="Add">
                                </div>
                            </div>
                        </form>
                    </div>
                </uib-tab>

            </uib-tabset>

        </div>
    </div>
</div></div>

